/*! cachejs - v0.1.1 - 2012-12-28 */
(function(e,t){"use strict";typeof define=="function"&&define.amd?define(["backbone","jquery","underscore","jquery.store"],t):e.Backbone.Cache=t(e.Backbone,e.jQuery,e._)})(this,function(e,t,n){"use strict";var r={cache:new e.Model,store:new t.store,scrambled:!1,encoder:null,setEncoder:function(e){n.isObject(e)&&(this.encoder=e)},setScramble:function(e){n.isBoolean(e)&&(this.scrambled=e)},scramble:function(e){if(!this.encoder||this.encoder&&!n.isFunction(this.encoder.encode))throw new Error("Cache Encoder Not Set");return this.encoder.encode(e)},unscramble:function(e){if(!this.encoder||this.encoder&&!n.isFunction(this.encoder.decode))throw new Error("Cache Decoder Not Set");return this.encoder.decode(e)},getItem:function(e,t){var n=this.cache.get(e);if(!n||t){if(this.scrambled){var r=this.scramble(e);n=this.unscramble(this.store.get(r));try{n=JSON.parse(n)}catch(i){n=null,this.store.del(r),this.cache.unset(e,{silent:!0})}}else n=this.store.get(e);this.cache.set(e,n,{silent:!0})}return n},setItem:function(e,t){return this.scrambled?this.store.set(this.scramble(e),this.scramble(JSON.stringify(t))):this.store.set(e,t),this.cache.set(e,t),t},removeItem:function(e){this.cache.unset(e),this.store.del(this.scrambled?this.scramble(e):e)},flush:function(){this.cache.clear(),this.store.flush()}};return r.set=r.setItem,r.get=r.getItem,r.unset=r.removeItem,function(){r.store.driver.scope="browser",r.store.encoders=["xml","json"],r.store.decoders=["json","xml"]}(),r});